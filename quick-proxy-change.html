<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Quick Proxy Change</title>
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self'; script-src 'self'; style-src 'self' 'nonce-abc123'">
    <style nonce="abc123">

        /* ---------- Base / Reset ---------- */
        *, *::before, *::after { box-sizing: border-box; }
        :root{
            --bg: #f6f7fb;
            --card: #ffffff;
            --text: #1f2937;
            --muted: #6b7280;
            --primary: #2563eb;
            --primary-600:#1d4ed8;
            --ring: rgba(37, 99, 235, .25);
            --border:#e5e7eb;
            --success:#16a34a;
            --success-50:#ecfdf5;
            --success-200:#bbf7d0;
            --error:#dc2626;
            --error-50:#fef2f2;
            --error-200:#fecaca;
            --shadow: 0 10px 25px rgba(17,24,39,.08);
            --radius: 12px;
        }
        @media (prefers-color-scheme: dark){
            :root{
                --bg:#0b1020;
                --card:#111827;
                --text:#e5e7eb;
                --muted:#9ca3af;
                --primary:#60a5fa;
                --primary-600:#3b82f6;
                --ring: rgba(96,165,250,.3);
                --border:#1f2937;
                --shadow: 0 10px 30px rgba(0,0,0,.45);
                --success:#22c55e;
                --success-50:#052e1a;
                --success-200:#134e31;
                --error:#ef4444;
                --error-50:#2a0e0e;
                --error-200:#7f1d1d;
            }
            .quick-proxy-header p { color: var(--muted); }
        }

        html, body {
            height: 100%;
            margin: 0;
            font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;
            color: var(--text);
            background:
                    radial-gradient(1200px 600px at -10% -20%, rgba(99,102,241,.08), transparent 40%),
                    radial-gradient(1000px 500px at 110% 120%, rgba(59,130,246,.08), transparent 40%),
                    var(--bg);
        }

        .quick-proxy-container {
            padding: 28px;
            max-width: 520px;
            margin: 0 auto;
        }

        /* ---------- Header ---------- */
        .quick-proxy-header {
            text-align: center;
            margin-bottom: 18px;
        }
        .quick-proxy-header h2 {
            margin: 0 0 8px;
            font-size: 22px;
            letter-spacing: .2px;
        }
        .quick-proxy-header p {
            margin: 0;
            font-size: 14px;
            color: var(--muted);
        }

        /* ---------- Card ---------- */
        .quick-proxy-form {
            background: linear-gradient(180deg, color-mix(in oklab, var(--card) 96%, transparent), var(--card));
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 22px;
            box-shadow: var(--shadow);
            backdrop-filter: saturate(1.1) blur(2px);
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }

        /* ---------- Input ---------- */
        .input-group{
            position: relative;
            margin-bottom: 14px;
        }
        .input-prefix {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 12px;
            color: var(--muted);
            opacity: .9;
            pointer-events: none;
        }
        .quick-proxy-input {
            width: 100%;
            padding: 12px 12px 12px 36px; /* space for prefix */
            font-size: 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: color-mix(in oklab, var(--card) 96%, transparent);
            color: var(--text);
            transition: border-color .2s, box-shadow .2s, background .2s, transform .04s ease;
        }
        .quick-proxy-input:focus-visible {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px var(--ring);
        }
        .quick-proxy-input::placeholder { color: color-mix(in oklab, var(--muted) 85%, transparent); }
        .quick-proxy-input.invalid {
            border-color: var(--error);
            box-shadow: 0 0 0 4px color-mix(in oklab, var(--error) 25%, transparent);
        }
        .quick-proxy-input.valid {
            border-color: var(--success);
            box-shadow: 0 0 0 4px color-mix(in oklab, var(--success) 25%, transparent);
        }

        .help-text {
            font-size: 12px;
            color: var(--muted);
            margin: 6px 0 0;
            line-height: 1.45;
        }

        /* ---------- Validation / Status ---------- */
        .validation-message {
            font-size: 12px;
            margin-top: 6px;
            display: none;
        }
        .validation-message.error { color: var(--error); display: block; }
        .validation-message.success { color: var(--success); display: block; }

        .status-message {
            padding: 12px;
            border-radius: 10px;
            margin-top: 16px;
            font-size: 14px;
            border: 1px solid transparent;
            display: none;
        }
        .status-message.success {
            display: block;
            background: var(--success-50);
            color: color-mix(in oklab, var(--success) 92%, white);
            border-color: var(--success-200);
        }
        .status-message.error {
            display: block;
            background: var(--error-50);
            color: color-mix(in oklab, var(--error) 92%, white);
            border-color: var(--error-200);
        }

        /* ---------- Buttons ---------- */
        .quick-proxy-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 22px;
        }
        .quick-proxy-btn {
            padding: 10px 16px;
            border: 1px solid var(--border);
            border-radius: 999px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: transform .05s ease, box-shadow .2s, background .2s, border-color .2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 108px;
            user-select: none;
        }
        .quick-proxy-btn:active { transform: translateY(1px); }
        .quick-proxy-btn:disabled { opacity: .6; cursor: not-allowed; }

        .cancel-btn {
            background: transparent;
        }
        .cancel-btn:hover { background: color-mix(in oklab, var(--card) 86%, transparent); }

        .apply-btn {
            background: linear-gradient(180deg, color-mix(in oklab, var(--primary) 92%, white), var(--primary));
            color: white;
            border-color: color-mix(in oklab, var(--primary-600) 70%, var(--primary));
            box-shadow: 0 6px 16px color-mix(in oklab, var(--primary) 25%, transparent);
        }
        .apply-btn:hover:not(:disabled){
            box-shadow: 0 10px 20px color-mix(in oklab, var(--primary) 30%, transparent);
            filter: saturate(1.05);
        }

        /* ---------- Spinner ---------- */
        .spinner {
            display: none;
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border: 2px solid rgba(255,255,255,.35);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .apply-btn.is-loading .spinner { display: inline-block; }

        /* ---------- Motion preferences ---------- */
        @media (prefers-reduced-motion: reduce){
            .quick-proxy-btn, .quick-proxy-input { transition: none; }
            .spinner { animation: none; }
        }
    </style>
</head>
<body>
<div class="quick-proxy-container">
    <div class="quick-proxy-header">
        <h2>Quick Proxy Change</h2>
        <p>Change proxy without reloading the current session</p>
    </div>

    <div class="quick-proxy-form">
        <label for="proxy-url">Enter proxy URL</label>
        <div class="input-group">
            <span class="input-prefix">ðŸ”—</span>
            <input
                    type="text"
                    id="proxy-url"
                    class="quick-proxy-input"
                    placeholder="http://user:pass@host:port   or   socks5://user:pass@host:port"
                    inputmode="url"
                    autocomplete="off"
                    spellcheck="false"
            >
            <div id="validation-message" class="validation-message"></div>
        </div>

        <p class="help-text">
            We wonâ€™t hard-validate the format here. Your session will switch to the provided proxy immediately.
        </p>

        <div id="status-message" class="status-message" aria-live="polite"></div>

        <div class="quick-proxy-buttons">
            <button id="cancel-btn" class="quick-proxy-btn cancel-btn" type="button">Cancel</button>
            <button id="apply-btn" class="quick-proxy-btn apply-btn" type="button">
                <div id="spinner" class="spinner"></div>
                <span>Apply</span>
            </button>
        </div>
    </div>
</div>

<script src="quick-proxy-change.js"></script>
</body>
</html>
